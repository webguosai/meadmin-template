import{_ as g}from"./index-lV_ixfDb.js";import{m as q,t as D,s as S,A as R,d as F}from"./add-bML5BdWU.js";import{bu as K,ai as N,_ as O}from"./index-yH0Ry0aD.js";import{E as w}from"./index-sftZIlHI.js";import{o as U}from"./omit-VLrBXF-t.js";import{E as j}from"./index-yGiInI68.js";import{d as C,r as d,x as L,i as u,o as Q,c as V,k as e,w as s,B as i,j as z,O as b,s as G}from"./core-ST-i4T9p.js";import"./pagination-sRyW0GdJ.js";import"./elIcon-sXDKzXmT.js";import"./index-T5KmWP1B.js";import"./index-L9fZwOev.js";import"./event-vOXeFsAk.js";import"./index-bdn5t8Of.js";import"./strings-tW-KZ-C8.js";import"./scroll-8BrWMcLm.js";import"./identity-Cx94HuMG.js";import"./vue.runtime.esm-bundler-HQOW8PNi.js";import"./mock-iVyY1y2-.js";import"./index-94vktnnO.js";import"./index-1biW9QUL.js";import"./flatten-h9WQF0ki.js";import"./index-pVHqEiMP.js";import"./dropdown-Qa4E4y1i.js";import"./index-e0v0gqzN.js";import"./index-E1Vaaaoc.js";import"./castArray-IgVPsfCg.js";import"./index-CwdKmFto.js";import"./index-tBBv9sFb.js";import"./index-QoQCtQxX.js";import"./index-FnUpZ9Gc.js";import"./index-hw4zphJd.js";import"./refs-J1jeHUpR.js";import"./isPlainObject-5qL80Wr3.js";import"./validator-Bzbif_xy.js";const H={clss:"menu"},J=C({setup:!0,name:"Menu",getComponents:()=>[u("vxe-column"),u("mel-icon-edit"),w,u("mel-icon-delete"),g,R]}),P=C({...J,__name:"menu",props:{checkedRules:{type:Array,default:()=>[]}},emits:["subRules"],setup(A,{emit:T}){const v=A,B=T,m=d(!1),r=d(),l=q();L(()=>[v.checkedRules,l.data.value],async()=>{!l.data.value||!l.data.value.length||(await r.value.vxeTableRef.clearCheckboxRow(),r.value.vxeTableRef.setCheckboxRow(v.checkedRules.reduce((n,o)=>{const a=r.value.vxeTableRef.getRowById(o);return a.children||n.push(a),n},[]),!0))});let h=[];const p=d(""),x=n=>{l.data.value=K(n,["name","rule"],h),G(()=>r.value.vxeTableRef.setAllTreeExpand(!0))},c=async()=>{await l.runAsync(),h=N(l.data.value),x(r.value.searchText)};c();const k=d(),y=n=>{k.value=n?U(n,["children"]):void 0,m.value=!0},E=n=>{j.confirm("确认删除所选菜单?").then(()=>{F().runAsync(n).then(c)}).catch(()=>{})};return(n,o)=>{const a=u("vxe-column"),M=u("mel-icon-edit"),f=w,$=u("mel-icon-delete"),I=g;return Q(),V("div",H,[e(I,{ref_key:"menuRef",ref:r,"quick-search":i(p),"onUpdate:quickSearch":o[1]||(o[1]=t=>b(p)?p.value=t:null),data:i(l).data.value??[],loading:i(l).loading.value,"custom-column":!1,"tree-config":{expandAll:!0,line:!0,reserve:!0},"checkbox-config":{labelField:"id"},"row-config":{keyField:"rule",useKey:!0},"column-config":{useKey:!0},align:"center",border:"","me-class":"table-menu",height:"auto","show-overflow":"",onRefresh:c,onQuickSearch:x,onAdd:o[2]||(o[2]=t=>y())},{toolsButton:s(()=>[e(f,{type:"success",onClick:o[0]||(o[0]=t=>B("subRules",i(r).vxeTableRef.getCheckboxRecords(!0).map(_=>_.rule)))},{default:s(()=>[z("保存")]),_:1})]),default:s(()=>[e(a,{type:"checkbox",title:"ID","tree-node":"",width:"240px",align:"left","header-align":"center"}),e(a,{field:"name",title:"菜单",type:"html"}),e(a,{field:"rule",title:"规则",type:"html"}),e(a,{field:"type",title:"类型",formatter:({row:t})=>D[t.type]},null,8,["formatter"]),e(a,{field:"sort",title:"排序"}),e(a,{field:"status",title:"状态",formatter:({row:t})=>S[t.status]},null,8,["formatter"]),e(a,{title:"操作"},{default:s(({row:t})=>[e(f,{type:"primary",link:"",onClick:_=>y(t)},{default:s(()=>[e(M)]),_:2},1032,["onClick"]),e(f,{type:"danger",link:"",onClick:_=>E(t.id)},{default:s(()=>[e($)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["quick-search","data","loading"]),e(R,{show:i(m),"onUpdate:show":o[3]||(o[3]=t=>b(m)?m.value=t:null),data:i(k),onSuccess:o[4]||(o[4]=t=>c())},null,8,["show","data"])])}}}),Me=O(P,[["__scopeId","data-v-766d700b"]]);export{Me as default};
